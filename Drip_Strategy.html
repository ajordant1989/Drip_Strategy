<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRIP Strategy Calculator & Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,500;1,400;1,500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="global.css">
</head>

<body>
    <div class="container">
        <!-- Sticky Navigation Bar AT TOP -->
        <nav class="sticky-nav bespoke-nav">
            <div class="nav-content"
                style="max-width:1280px; margin:0 auto; width:100%; display:flex; align-items:center; justify-content:space-between;">
                <div class="nav-left">
                    <img src="images/bespoke-white.svg" alt="Bespoke Financial Logo" class="bespoke-logo">
                </div>
                <div class="nav-right">
                    <a class="nav-link" href="Past_Drip_Calculations.html">Past Drip Calculations</a>
                    <p class="nav-link" onclick="saveCurrentView()" style="cursor:pointer;">Save View</p>
                    <button class="btn-gold nav-calc-btn" id="calculateStrategyNavBtn"
                        onclick="calculateAndScroll()">Calculate
                        strategy</button>
                </div>
            </div>
        </nav>
        <div style="text-align:center; margin:32px;">
            <h3>DRIP Calculator</h3>
            <h1>Strategy Tracker</h1>
        </div>

        <div class="results full-width" id="results" style="display: flex;">
            <div class="result-card">
                <h3>Blended Yield</h3>
                <div class="value" id="blendedYield">0%</div>
            </div>
            <div class="result-card">
                <h3 id="incomeLabel">Weekly Income</h3>
                <div class="value" id="incomeValue">$0</div>
            </div>
            <div class="result-card">
                <h3>Annual Income</h3>
                <div class="value" id="annualIncome">$0</div>
            </div>
            <div class="result-card">
                <h3>Time to Target</h3>
                <div class="value" id="timeToTarget">0 months</div>
            </div>
        </div>

        <section class="full-width" style="margin-bottom: 16px;">
            <div class="portfolio-setup">
                <h2 style="display:inline-flex; align-items:center;gap:4px;"><svg xmlns="http://www.w3.org/2000/svg"
                        fill="none" viewBox="0 0 24 24" strokeWidth="1.5" stroke="#DDBD85" width="24" height="24">
                        <path strokeLinecap="round" strokeLinejoin="round"
                            d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z" />
                    </svg> Portfolio Setup</h2>
                <div class="input-group">
                    <div style="display: flex; flex-direction: column; position: relative;">
                        <label for="totalInvestment" style="display: flex; align-items: center;">
                            Starting Invesment
                            <span class="tooltip-icon" tabindex="0" style="margin-left: 8px;">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" fill="#FFFFFF" />
                                    <text x="12" y="16" text-anchor="middle" font-size="16" fill="#000"
                                        font-family="Inter, Arial" font-weight="bold">?</text>
                                </svg>
                                <span class="tooltip-text">
                                    Amount you plan to add to your ETFs
                                </span>
                            </span>
                        </label>
                        <div class="input-row">
                            <span class="input-unit input-unit-left" aria-hidden="true">$</span>
                            <input type="text" id="totalInvestment" min="0" placeholder="0"
                                class="with-unit input-no-border" data-unit="$">
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; position: relative;">
                        <label for="targetAmount" style="display: flex; align-items: center;">
                            Target Amount
                            <span class="tooltip-icon" tabindex="0" style="margin-left: 8px;">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" fill="#FFFFFF" />
                                    <text x="12" y="16" text-anchor="middle" font-size="16" fill="#000"
                                        font-family="Inter, Arial" font-weight="bold">?</text>
                                </svg>
                                <span class="tooltip-text">
                                    This is your goal amount you wish to make from this strategy
                                </span>
                            </span>
                        </label>
                        <div class="input-row">
                            <span class="input-unit input-unit-left" aria-hidden="true">$</span>
                            <input type="text" id="targetAmount" min="0" placeholder="0"
                                class="with-unit input-no-border">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="full-width" style="margin-bottom: 16px;">
            <div class="portfolio-positions">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <h2 style="display:inline-flex; align-items:center;gap:4px;"><svg xmlns="http://www.w3.org/2000/svg"
                            fill="none" viewBox="0 0 24 24" strokeWidth='1.5' stroke="#DDBD85" width="24" height="24">
                            <path strokeLinecap="round" strokeLinejoin="round"
                                d="M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5m.75-9 3-3 2.148 2.148A12.061 12.061 0 0 1 16.5 7.605" />
                        </svg>
                        Portfolio Positions</h2>
                    <button class="add-position-text-btn" onclick="openAddPositionModal()" type="button">+ Add New
                        Position
                    </button>
                </div>
                <div id="allocationError" class="error-message" style="display: none;"></div>
                <table class="portfolio-table" id="portfolioTable">
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Allocation %</th>
                            <th>Amount</th>
                            <th>Yield %</th>
                            <th>Annual Income</th>
                            <th>Weekly Income</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="portfolioBody">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Integration Grid Toggle Switch -->
        <div class="card"
            style="width:100%; display:flex;align-items: center; justify-content:space-between; margin-bottom:16px;">
            <h2 style="display:inline-flex; align-items:center;gap:4px;"><svg xmlns="http://www.w3.org/2000/svg"
                    fill="none" color="#DDBD85" viewBox="0 0 24 24" strokeWidth="1.5" stroke="#DDBD85" width="24"
                    height="24">
                    <path strokeLinecap="round" strokeLinejoin="round"
                        d="M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
                Additional Income</h2>
            <div style="display: flex; align-items: center;">
                <label class="toggle-switch" id="integrationToggleLabel">
                    <input type="checkbox" id="toggleIntegrationGridSwitch" checked>
                    <span class="slider"></span>
                </label>
                <span id="toggleIntegrationGridText"
                    style="margin-left:12px; color:#fff; font-weight:400; font-size:.95rem;margin-bottom:8px;">Hide
                    Integrations</span>
            </div>
        </div>

        <div id="integrationGridContainer" style="width: 100%;">
            <div class="integration-grid" style="display: flex; gap: 32px; width: 100;">
                <div class="card iul-integration">
                    <h2 style="display:inline-flex; align-items:center;gap:4px;"><svg xmlns="http://www.w3.org/2000/svg"
                            fill="none" viewBox="0 0 24 24" strokeWidth="1.5" color="#DDBD85" stroke="currentColor"
                            width="24" height="24">
                            <path strokeLinecap="round" strokeLinejoin="round"
                                d="M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                        </svg>
                        IUL Integration</h2>
                    <div class="input-group">
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="iulPremium">Monthly IUL Premium</label>
                            <div class="input-row">
                                <span class="input-unit input-unit-left" aria-hidden="true">$</span>
                                <input type="text" id="iulPremium" min="0" placeholder="0"
                                    class="with-unit input-no-border">
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="iulCashValue">Current Cash Value</label>
                            <div class="input-row">
                                <span class="input-unit input-unit-left" aria-hidden="true">$</span>
                                <input type="text" id="iulCashValue" min="0" placeholder="0"
                                    class="with-unit input-no-border">
                            </div>
                        </div>
                    </div>
                    <div class="input-group">
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="iulGrowthRate">Expected Growth Rate</label>
                            <div class="input-row">
                                <input type="number" id="iulGrowthRate" min="0" placeholder="0" class="with-unit">
                                <span class="input-unit input-unit-right">%</span>
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="reinvestToIUL">Reinvest % to IUL</label>
                            <div class="input-row">
                                <input type="number" id="reinvestToIUL" min="0" max="100" placeholder="0"
                                    class="with-unit">
                                <span class="input-unit input-unit-right">%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card bitcoin-integration">
                    <h2><span style="color:#DDBD85;margin-right:4px;">₿</span>Bitcoin Integration</h2>
                    <div class="input-group">
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="bitcoinAmountBTC">Current Bitcoin Amount (BTC)</label>
                            <div class="input-row">
                                <input type="number" id="bitcoinAmountBTC" min="0" placeholder="0"
                                    class="with-unit input-no-border" data-unit="BTC">
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="bitcoinPriceUSD">Current Bitcoin Price</label>
                            <div class="input-row">
                                <span class="input-unit input-unit-left" aria-hidden="true">$</span>
                                <input type="text" id="bitcoinPriceUSD" min="0" placeholder="0"
                                    class="with-unit input-no-border" data-unit="$">
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="bitcoinCAGR">Bitcoin CAGR (%)</label>
                            <div class="input-row">
                                <input type="number" id="bitcoinCAGR" min="0" placeholder="0"
                                    class="with-unit input-no-border">
                                <span class="input-unit input-unit-right">%</span>
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="bitcoinMonthlySavingsUSD">Monthly Bitcoin Savings</label>
                            <div class="input-row">
                                <span class="input-unit input-unit-left" aria-hidden="true">$</span>
                                <input type="text" id="bitcoinMonthlySavingsUSD" min="0" placeholder="0"
                                    class="with-unit input-no-border">
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; position: relative;">
                            <label for="reinvestToBitcoin">Reinvest % to Bitcoin</label>
                            <div class="input-row">
                                <input type="number" id="reinvestToBitcoin" min="0" max="100" placeholder="0"
                                    class="with-unit input-no-border">
                                <span class="input-unit input-unit-right">%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="projection-chart card full-width" style="height:600px;" id="projectionChartContainer">
            <h2 style="display:inline-flex; align-items:center;gap:4px;"><svg xmlns="http://www.w3.org/2000/svg"
                    fill="none" viewBox="0 0 24 24" strokeWidth='1.5' stroke="#DDBD85" width="24" height="24">
                    <path strokeLinecap="round" strokeLinejoin="round"
                        d="M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5m.75-9 3-3 2.148 2.148A12.061 12.061 0 0 1 16.5 7.605" />
                </svg> Monthly Growth Projection</h2>
            <canvas id="wealthChart" style="margin-bottom: 16px; height: 400px; width: 100%;"></canvas>
            <div class="table-scroll">
                <table class="projection-table" id="projectionTable" style="width: 100%; max-width: 1280px;">
                    <thead>
                        <tr>
                            <th>Month</th>
                            <th>Portfolio Value</th>
                            <th>Monthly Income</th>
                            <th>IUL Value</th>
                            <th>Bitcoin Value</th>
                            <th>Total Wealth</th>
                        </tr>
                    </thead>
                    <tbody id="projectionBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add floating calculate button -->
    <div class="floating-btn-container">
        <!-- Floating button group removed, navigation now handles Calculate -->
    </div>

    <div class="modal" id="addPositionModal">
        <div class="modal-content">
            <h3>Add New Position</h3>
            <div class="input-group">
                <div style="display: flex; flex-direction: column;">
                    <label for="modalTicker">Ticker Symbol</label>
                    <input type="text" id="modalTicker" placeholder="e.g., AAPL" class="input-row">
                </div>
                <div style="display: flex; flex-direction: column;">
                    <label for="modalAllocation">Allocation (%)</label>
                    <input type="number" id="modalAllocation" step="0.1" min="0" placeholder="e.g., 25"
                        class="input-row">
                </div>
                <div style="display: flex; flex-direction: column;">
                    <label for="modalYield">Yield (%)</label>
                    <input type="number" id="modalYield" step="0.1" min="0" placeholder="e.g., 5" class="input-row">
                </div>
                <div style="display: flex; flex-direction: column;">
                    <label for="modalFrequency">Distribution Frequency</label>
                    <select id="modalFrequency" class="input-row">
                        <option value="52">Weekly (52x/year)</option>
                        <option value="13" selected>Monthly (13x/year)</option>
                    </select>
                </div>
            </div>
            <div id="modalError" class="error-message" style="display: none;"></div>
            <button class="btn" id="modalSubmitBtn" onclick="submitNewPosition()">Add Position</button>
            <button class="close-btn" onclick="closeAddPositionModal()">Cancel</button>
        </div>
    </div>

    <div class="modal" id="saveViewModal">
        <div class="modal-content">
            <h3>Name This Saved View</h3>
            <div class="input-group">
                <input type="text" id="saveViewNameInput" class="input-row" placeholder="e.g., My DRIP Plan">
            </div>
            <div id="saveViewError" class="error-message" style="display:none;"></div>
            <button class="btn" id="saveViewSubmitBtn">Save</button>
            <button class="close-btn" onclick="closeSaveViewModal()">Cancel</button>
        </div>
    </div>

    <script>
        // ...existing code...
    </script>
</body>

</html>